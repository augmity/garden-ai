<header>
  <h3 nz-typography>GardenAI</h3>
</header>

<content>
  <time-period-selector (modelChange)="dataService.timePeriod = $event"></time-period-selector>

  <div class="chart">
    <ngx-charts-area-chart
      [scheme]="{ domain: ['#ffcd32'] }"
      legend="true"
      showYAxisLabel="true"
      xAxis="true"
      yAxis="true"
      yAxisLabel="Light (lux)"
      [results]="lightChartData"
      autoScale="true"
      [showGridLines]="false"
      [gradient]="true"
      [legend]="false"
      legendPosition="below"
    >
      <ng-template #tooltipTemplate let-model="model">
        <div class="tooltip">
          <div>{{ model.name | date:'yyyy-MM-dd hh:mm:ss' }}</div>
          <div style="font-size: 16px">{{ model.value }} lux</div>
        </div>
      </ng-template>

      <ng-template #seriesTooltipTemplate let-model="model">
        <div class="tooltip">
          <div>{{ model[0].name | date:'yyyy-MM-dd hh:mm:ss' }}</div>
          <div style="font-size: 16px">{{ model[0].value }} lux</div>
        </div>
      </ng-template>

    </ngx-charts-area-chart>
  </div>

  <div class="chart">
    <ngx-charts-area-chart
      [scheme]="{ domain: ['#52c41a'] }"
      legend="true"
      showYAxisLabel="true"
      xAxis="true"
      yAxis="true"
      yAxisLabel="Soil Moisture"
      [results]="soilMoistureChartData"
      autoScale="true"
      [showGridLines]="false"
      [gradient]="true"
      [legend]="false"
      legendPosition="below"
    >
      <ng-template #tooltipTemplate let-model="model">
        <div class="tooltip">
          <div>{{ model.name | date:'yyyy-MM-dd hh:mm:ss' }}</div>
          <div style="font-size: 16px">{{ model.value }}</div>
        </div>
      </ng-template>

      <ng-template #seriesTooltipTemplate let-model="model">
        <div class="tooltip">
          <div>{{ model[0].name | date:'yyyy-MM-dd hh:mm:ss' }}</div>
          <div style="font-size: 16px">{{ model[0].value }}</div>
        </div>
      </ng-template>

    </ngx-charts-area-chart>
  </div>


  <ng-container *ngIf="dataService.sensorsData$ | async as data">
    <nz-table #table nzSize="middle" [nzData]="data">
      <thead>
        <tr>
          <th>Date</th>
          <th>Light (lux)</th>
          <th>Soil Moisture</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of table.data">
          <td>{{ item.CreatedOn | date:'yyyy-MM-dd hh:mm:ss' }}</td>
          <td>{{ item.Light }}</td>
          <td>{{ item.SoilMoisture }}</td>
        </tr>
      </tbody>
    </nz-table>
  </ng-container>


  <!-- <ng-container *ngIf="dataService.sashData$ | async as sashdata">
    <div id="currentStatePanel">
      <div>
        <nz-progress [nzPercent]="sashdata?.position" nzType="circle" [nzFormat]="formatPosition"></nz-progress>
        Sash Opening
      </div>
      <div>
        <nz-progress [nzPercent]="sashdata?.position" nzType="circle" [nzFormat]="formatEnergy"></nz-progress>
        Energy Consumption
      </div>
    </div>
  </ng-container> -->


  <!-- <ngx-charts-line-chart
    [view]="view"
    [showGridLines]="false"
    [scheme]="{ domain: ['#5AA454'] }"
    legend="true"
    showYAxisLabel="true"
    xAxis="true"
    yAxis="true"
    yAxisLabel="%"
    [results]="sashlightChartData"
    autoScale="true"
    [trimXAxisTicks]="true"
    [maxXAxisTickLength]="16"
  >
  </ngx-charts-line-chart> -->

</content>